/**
 * @license ng-alain(cipchk@qq.com) v7.0.3
 * (c) 2019 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("file-saver"),require("@angular/common"),require("@angular/core"),require("@delon/util")):"function"==typeof define&&define.amd?define("@delon/abc/xlsx",["exports","@angular/common/http","file-saver","@angular/common","@angular/core","@delon/util"],t):t((e.delon=e.delon||{},e.delon.abc=e.delon.abc||{},e.delon.abc.xlsx={}),e.ng.common.http,e.saveAs,e.ng.common,e.ng.core,e.delon.util)}(this,function(e,t,r,n,o,i){"use strict";var a=function(){function e(){this.url="//cdn.bootcss.com/xlsx/0.12.13/xlsx.full.min.js",this.modules=[]}return e.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=o.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function l(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}var u=function(){function e(e,t,r){this.cog=e,this.http=t,this.lazy=r}return e.prototype.init=function(){return this.lazy.load([this.cog.url].concat(this.cog.modules))},e.prototype.read=function(r){var n={};return r.SheetNames.forEach(function(e){var t=r.Sheets[e];n[e]=XLSX.utils.sheet_to_json(t,{header:1})}),n},e.prototype["import"]=function(n,o){var i=this;return void 0===o&&(o="readAsBinaryString"),new Promise(function(r,t){i.init().then(function(){if("string"!=typeof n){var e=new FileReader;e.onload=function(e){var t=XLSX.read(e.target.result,{type:"binary"});r(i.read(t))},e[o](n)}else i.http.request("GET",n,{responseType:"arraybuffer"}).subscribe(function(e){var t=XLSX.read(new Uint8Array(e),{type:"array"});r(i.read(t))},function(e){t(e)})})})},e.prototype["export"]=function(t){return this.init().then(function(){var n=XLSX.utils.book_new();Array.isArray(t.sheets)?t.sheets.forEach(function(e,t){var r=XLSX.utils.aoa_to_sheet(e.data);XLSX.utils.book_append_sheet(n,r,e.name||"Sheet"+(t+1))}):(n.SheetNames=Object.keys(t.sheets),n.Sheets=t.sheets),t.callback&&t.callback(n);var e=XLSX.write(n,c({bookType:"xlsx",bookSST:!1,type:"array"},t.opts));r.saveAs(new Blob([e],{type:"application/octet-stream"}),t.filename||"export.xlsx")})},e.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:a},{type:t.HttpClient},{type:i.LazyService}]},e.ngInjectableDef=o.defineInjectable({factory:function(){return new e(o.inject(a),o.inject(t.HttpClient),o.inject(i.LazyService))},token:e,providedIn:"root"}),e}(),f=function(){function e(e){this.srv=e}return e.prototype._click=function(){this.srv["export"](this.data)},e.decorators=[{type:o.Directive,args:[{selector:"[xlsx]",host:{"(click)":"_click()"},exportAs:"xlsxDirective"}]}],e.ctorParameters=function(){return[{type:u}]},e.propDecorators={data:[{type:o.Input,args:["xlsx"]}]},e}(),p=[f],d=function(){function e(){}return e.decorators=[{type:o.NgModule,args:[{imports:[n.CommonModule,i.DelonUtilModule],declarations:l(p),exports:l(p)}]}],e}();e.XlsxConfig=a,e.XlsxService=u,e.XlsxDirective=f,e.XlsxModule=d,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=xlsx.umd.min.js.map