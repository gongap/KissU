!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-countdown",["exports","@angular/common","@angular/core"],e):e(t["ngx-countdown"]={},t.ng.common,t.ng.core)}(this,function(t,e,o){"use strict";var n=function(){function t(){this.fns=[],this.commands=[],this.ing=!1}return t.prototype.start=function(){!0!==this.ing&&(this.ing=!0,this.nextTime=+new Date,this.process())},t.prototype.process=function(){for(var t=this;this.commands.length;)this.commands.shift()();var e,n,o,i,s=+new Date-this.nextTime,r=1+Math.floor(s/100);for(s=100-s%100,this.nextTime+=100*r,o=0,i=this.fns.length;o<i;o+=2)0===(e=this.fns[o+1])?this.fns[o](r):(e+=2*r-1,0<(n=Math.floor(e/20))&&this.fns[o](n),this.fns[o+1]=e%20+1);this.ing&&setTimeout(function(){return t.process()},s)},t.prototype.add=function(t,e){var n=this;this.commands.push(function(){n.fns.push(t),n.fns.push(1e3===e?1:0),n.ing=!0})},t.prototype.remove=function(e){var n=this;this.commands.push(function(){var t=n.fns.indexOf(e);-1!==t&&n.fns.splice(t,2),n.ing=0<n.fns.length})},t.decorators=[{type:o.Injectable}],t}(),r=function(){function t(){this.demand=!1,this.leftTime=0,this.template="$!h!时$!m!分$!s!秒",this.effect="normal",this.varRegular=/\$\!([\-\w]+)\!/g,this.clock=["d",100,2,"h",24,2,"m",60,2,"s",60,2,"u",10,1]}return t.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=o.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=function(){function t(t,e,n){this.el=t,this.timer=e,this.cog=n,this.frequency=1e3,this._notify={},this.hands=[],this.left=0,this.paused=!1,this.stoped=!1,this.start=new o.EventEmitter,this.finished=new o.EventEmitter,this.notify=new o.EventEmitter,this.event=new o.EventEmitter}return t.prototype.begin=function(){this.paused=!1,this.start.emit(),this.callEvent("start")},t.prototype.restart=function(){this.stoped||this.destroy(),this.init(),this.callEvent("restart")},t.prototype.stop=function(){this.stoped||(this.stoped=!0,this.destroy(),this.callEvent("stop"))},t.prototype.pause=function(){this.stoped||this.paused||(this.paused=!0,this.callEvent("pause"))},t.prototype.resume=function(){!this.stoped&&this.paused&&(this.paused=!1,this.callEvent("resume"))},t.prototype.callEvent=function(t){this.event.emit({action:t,left:this.left})},t.prototype.init=function(){var o=this;o.config=a({},new r,o.cog,o.config);var i=o.el.nativeElement;o.paused=o.config.demand,o.stoped=!1;var t=i.innerHTML||o.config.template;o.config.varRegular.lastIndex=0,i.innerHTML=t.replace(o.config.varRegular,function(t,e){"u"!==e&&"s-ext"!==e||(o.frequency=100);var n="";return"s-ext"===e?(o.hands.push({type:"s"}),o.hands.push({type:"u"}),n=o.html("","s","handlet")+o.html(".","","digital")+o.html("","u","handlet")):o.hands.push({type:e}),o.html(n,e,"hand")});var s=o.config.clock;o.hands.forEach(function(t){var e,n=t.type,o=100;for(t.node=i.querySelector(".hand-"+n),e=s.length-3;-1<e&&n!==s[e];e-=3)o*=s[e+1];t.base=o,t.radix=s[e+1],t.bits=s[e+2]}),o.getLeft(),o.reflow(0,!0);var e=o.reflow;return o.reflow=function(t){return void 0===t&&(t=0),e.apply(o,[t])},o.config.notify&&o.config.notify.forEach(function(t){if(t<1)throw new Error("the notify config must be a positive integer.");t*=1e3,t-=t%o.frequency,o._notify[t]=!0}),o.timer.add(o.reflow,o.frequency),i.style.display="inline",this.timer.start(),o},t.prototype.destroy=function(){return this.timer.remove(this.reflow),this},t.prototype.reflow=function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var n=this;(e||!n.paused&&!n.stoped)&&(n.left=n.left-n.frequency*t,n.hands.forEach(function(t){t.lastValue=t.value,t.value=Math.floor(n.left/t.base)%t.radix}),n.repaint(),n._notify[n.left]&&(n.notify.emit(n.left),n.callEvent("notify")),n.left<1&&(n.finished.emit(0),n.stoped=!0,n.callEvent("finished"),n.destroy()))},t.prototype.repaint=function(){var e,n=this;n.config.repaint?n.config.repaint.apply(n):n.hands.forEach(function(t){t.lastValue!==t.value&&(e="",n.toDigitals(t.value,t.bits).forEach(function(t){e+=n.html(t.toString(),"","digital")}),t.node.innerHTML=e)})},t.prototype.getLeft=function(){var t=1e3*this.config.leftTime,e=this.config.stopTime;!t&&e&&(t=e-(new Date).getTime()),this.left=t-t%this.frequency},t.prototype.html=function(t,e,n){switch(n){case"hand":case"handlet":e=n+" hand-"+e;break;case"digital":e="."===t?n+" "+n+"-point "+e:n+" "+n+"-"+t+" "+e}return'<span class="'+e+'">'+t+"</span>"},t.prototype.toDigitals=function(t,e){t=t<0?0:t;for(var n=[];e--;)n[e]=t%10,t=Math.floor(t/10);return n},t.prototype.ngOnInit=function(){this.init(),this.config.demand||this.begin()},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.ngOnChanges=function(t){t.config.firstChange||this.restart()},t.decorators=[{type:o.Component,args:[{selector:"countdown",template:"\n    <ng-content></ng-content>\n  ",host:{"[class.count-down]":"true"},encapsulation:o.ViewEncapsulation.None,changeDetection:o.ChangeDetectionStrategy.OnPush,styles:["\n      countdown {\n        display: none;\n      }\n    "]}]}],t.ctorParameters=function(){return[{type:o.ElementRef},{type:n},{type:r}]},t.propDecorators={config:[{type:o.Input}],start:[{type:o.Output}],finished:[{type:o.Output}],notify:[{type:o.Output}],event:[{type:o.Output}]},t}(),s=function(){function t(){}return t.decorators=[{type:o.NgModule,args:[{imports:[e.CommonModule],providers:[n],declarations:[i],exports:[i]}]}],t}();t.ɵa=r,t.CountdownComponent=i,t.Timer=n,t.CountdownModule=s,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-countdown.umd.min.js.map